
<div class="filter-wrapper">
  <% url = category.id == params[:category_id].to_i ? search_index_path( update_params( params, :remove, :category_id, category.id ) ) :
                      search_index_path( update_params( params, :update, :category_id, category.id ) ) %>
    <%= link_to url, data: { 'turbolinks-scroll': false }  do %>
    <label class="checkbox-style">
      <input id="<%= "category-#{category.id}" %>" type="checkbox" class="checkbox-inline" <%= category.searched_for?( params[:category_id], params[:sub_category_id] ) ? "checked='checked'" : "" %>>
        <% if params[:sub_category_id] %>
          <span class="dash"></span>
        <% else %>
          <span></span>
        <% end %>
    </label>
    <label for="<%= "category-#{category.id}" %>" class="filter-name"><%= category.name %></label>
  <% end %>
    <% if category.searched_for?( params[:category_id], params[:sub_category_id] ) %>
    <span class="filter-plus-icon glyphicon glyphicon-plus glyphicon-minus"></span>
    <div class="sub-filter-wrapper display">
    <% else %>
    <span class="filter-plus-icon glyphicon glyphicon-plus"></span>
    <div class="sub-filter-wrapper">
    <% end %>
        <% category.sub_categories.each do |sub_cat| %>
          <% url = sub_cat.id == params[:sub_category_id].to_i ? search_index_path( update_params( update_params( params, :remove, :sub_category_id, sub_cat.id ), :update, :category_id, category.id ) ) :
                              search_index_path( update_params( params, :update, :sub_category_id, sub_cat.id ) ) %>
            <%= link_to url, data: { 'turbolinks-scroll': false }, class: 'sub-filter-checkbox'  do %>
            <label class="checkbox-style">
              <input id="<%= "category-#{sub_cat.id}" %>" type="checkbox" class="checkbox-inline" <%= params[:sub_category_id].to_i == sub_cat.id ? "checked='checked'" : "" %>>
                <span></span>
            </label>
            <label for="<%= "category-#{sub_cat.id}" %>" class="filter-name"><%= sub_cat.name %></label>
          <% end %>
        <% end %>
    </div>
</div>
